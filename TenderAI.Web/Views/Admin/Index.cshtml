@{
    ViewData["Title"] = "Admin Panel - Faz 2";
}

<div class="container mt-4">
    <h1>üîß Admin Panel</h1>
    <p class="text-muted">Faz 2: ƒ∞hale Sonu√ß Toplama Sistemi</p>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @TempData["Success"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    @if (TempData["Warning"] != null)
    {
        <div class="alert alert-warning alert-dismissible fade show" role="alert">
            @TempData["Warning"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            @TempData["Error"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">üì• ƒ∞hale Sonu√ßlarƒ±nƒ± Topla</h5>
                </div>
                <div class="card-body">
                    <p class="card-text">
                        Tamamlanmƒ±≈ü ihalelerin sonu√ßlarƒ±nƒ± EKAP'tan √ßeker.
                        Benchmark sistemi i√ßin ge√ßmi≈ü ihale verilerini toplar.
                    </p>

                    <form asp-action="CollectResults" method="post" class="mt-3">
                        <div class="mb-3">
                            <label for="daysBack" class="form-label">Ka√ß g√ºn geriye bakƒ±lacak?</label>
                            <select class="form-select" id="daysBack" name="daysBack">
                                <option value="3">Son 3 g√ºn</option>
                                <option value="7" selected>Son 7 g√ºn</option>
                                <option value="14">Son 14 g√ºn</option>
                                <option value="30">Son 30 g√ºn</option>
                            </select>
                            <div class="form-text">
                                Se√ßilen s√ºre i√ßinde tamamlanmƒ±≈ü ve hen√ºz sonucu √ßekilmemi≈ü ihaleler taranacak.
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-download"></i> Sonu√ßlarƒ± Topla
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">‚ÑπÔ∏è Sistem Bilgileri</h5>
                </div>
                <div class="card-body">
                    <h6>Background Jobs:</h6>
                    <ul>
                        <li><strong>TenderSyncWorker:</strong> ƒ∞hale √ßekme (6 saatte bir)</li>
                        <li><strong>TenderResultCollectionWorker:</strong> Sonu√ß √ßekme (g√ºnde 1 kez)</li>
                    </ul>

                    <h6 class="mt-3">Konfig√ºrasyon:</h6>
                    <ul>
                        <li><strong>ResultCollectionIntervalHours:</strong> 24 saat</li>
                        <li><strong>ResultCollectionDaysBack:</strong> 7 g√ºn</li>
                    </ul>

                    <div class="alert alert-info mt-3">
                        <small>
                            <i class="bi bi-info-circle"></i>
                            Background worker otomatik olarak √ßalƒ±≈ümaktadƒ±r.
                            Manuel √ßekme sadece acil durumlarda kullanƒ±lmalƒ±dƒ±r.
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">üìä ƒ∞statistikler</h5>
                </div>
                <div class="card-body">
                    <p class="text-muted">
                        <i class="bi bi-clock-history"></i>
                        ƒ∞statistikler yakƒ±nda eklenecek...
                    </p>
                    <ul>
                        <li>Toplam √ßekilen sonu√ß sayƒ±sƒ±</li>
                        <li>Son 24 saatte √ßekilen sonu√ßlar</li>
                        <li>Parse ba≈üarƒ± oranƒ±</li>
                        <li>Ortalama s√∂zle≈üme bedeli</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <a asp-controller="Dashboard" asp-action="Index" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Dashboard'a D√∂n
        </a>
    </div>
</div>

@section Scripts {
    <script>
        // Auto-dismiss alerts after 5 seconds
        setTimeout(function() {
            var alerts = document.querySelectorAll('.alert');
            alerts.forEach(function(alert) {
                var bsAlert = new bootstrap.Alert(alert);
                bsAlert.close();
            });
        }, 5000);
    </script>
}
