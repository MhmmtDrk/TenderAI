@model TenderAI.Web.Models.DashboardViewModel
@{
    ViewData["Title"] = "Dashboard";
}

<div class="mb-4">
    <h1 class="h3 mb-3">ðŸ“Š Dashboard</h1>
    <p class="text-muted">TenderAI Kamu Ä°hale Analiz Platformu</p>
</div>

<!-- KPI Cards -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card bg-primary text-white">
            <div class="card-body">
                <h6 class="card-subtitle mb-2">Aktif Ä°haleler</h6>
                <h2 class="mb-0">@Model.ActiveTenderCount</h2>
                <small>Åžu anda aÃ§Ä±k</small>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card bg-success text-white">
            <div class="card-body">
                <h6 class="card-subtitle mb-2">Bu Ay Analiz</h6>
                <h2 class="mb-0">@Model.AnalyzedThisMonth</h2>
                <small>Tamamlanan analiz</small>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card bg-warning text-white">
            <div class="card-body">
                <h6 class="card-subtitle mb-2">Ortalama Risk</h6>
                <h2 class="mb-0">45/100</h2>
                <small>Genel risk skoru</small>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card bg-info text-white">
            <div class="card-body">
                <h6 class="card-subtitle mb-2">Potansiyel Tasarruf</h6>
                <h2 class="mb-0">â‚º2.5M</h2>
                <small>Ã–nerilen teklifler</small>
            </div>
        </div>
    </div>
</div>

<!-- Son Ä°haleler -->
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">ðŸ“„ Son Ä°haleler</h5>
        <a asp-controller="Tender" asp-action="Index" class="btn btn-sm btn-primary">TÃ¼mÃ¼nÃ¼ GÃ¶r</a>
    </div>
    <div class="card-body">
        @if (Model.RecentTenders.Any())
        {
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Ä°KN</th>
                            <th>Ä°hale AdÄ±</th>
                            <th>Kurum</th>
                            <th>Ä°l</th>
                            <th>Son Teklif Tarihi</th>
                            <th>YaklaÅŸÄ±k Maliyet</th>
                            <th>Risk Skoru</th>
                            <th>Ä°ÅŸlem</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var tender in Model.RecentTenders.Take(10))
                        {
                            <tr>
                                <td><code>@tender.IKN</code></td>
                                <td>
                                    <strong>@tender.Title</strong>
                                    <br />
                                    <small class="text-muted">@tender.TenderType</small>
                                </td>
                                <td>@tender.AuthorityName</td>
                                <td>@tender.Province</td>
                                <td>
                                    <span class="badge bg-secondary">
                                        @tender.BidDeadline.ToString("dd.MM.yyyy")
                                    </span>
                                </td>
                                <td>â‚º@tender.EstimatedCost.ToString("N0")</td>
                                <td>
                                    @if (tender.RiskScore.HasValue)
                                    {
                                        var badgeClass = tender.RiskLevel switch
                                        {
                                            "DÃ¼ÅŸÃ¼k" => "bg-success",
                                            "Orta" => "bg-warning",
                                            "YÃ¼ksek" => "bg-danger",
                                            _ => "bg-secondary"
                                        };
                                        <span class="badge @badgeClass">
                                            @tender.RiskLevel (@tender.RiskScore.Value.ToString("F0"))
                                        </span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-light text-dark">Analiz Yok</span>
                                    }
                                </td>
                                <td>
                                    <a asp-controller="Tender" asp-action="AnalysisWizard" asp-route-id="@tender.Id"
                                       class="btn btn-sm btn-success">
                                        <i class="bi bi-stars"></i> Analiz Et
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
        else
        {
            <div class="text-center py-5">
                <p class="text-muted">HenÃ¼z ihale kaydÄ± bulunmuyor.</p>
                <p><small>Veri toplama servisi Ã§alÄ±ÅŸtÄ±ÄŸÄ±nda ihaleler otomatik olarak burada gÃ¶rÃ¼necek.</small></p>
            </div>
        }
    </div>
</div>

<!-- HÄ±zlÄ± Aksiyonlar -->
<div class="row mt-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">ðŸš€ HÄ±zlÄ± BaÅŸlangÄ±Ã§</h5>
            </div>
            <div class="card-body">
                <ul class="list-unstyled">
                    <li class="mb-2">âœ… <strong>AdÄ±m 1:</strong> Ä°hale listesini inceleyin</li>
                    <li class="mb-2">âœ… <strong>AdÄ±m 2:</strong> Ä°lginizi Ã§eken bir ihale seÃ§in</li>
                    <li class="mb-2">âœ… <strong>AdÄ±m 3:</strong> "Analiz Et" butonuna tÄ±klayÄ±n</li>
                    <li class="mb-2">âœ… <strong>AdÄ±m 4:</strong> 9 adÄ±mlÄ±k wizard'Ä± tamamlayÄ±n</li>
                    <li class="mb-2">âœ… <strong>AdÄ±m 5:</strong> TenderAI'Ä±n Ã¶nerisini alÄ±n</li>
                </ul>
                <a asp-controller="Tender" asp-action="Index" class="btn btn-primary w-100 mt-3">
                    Ä°halelere GÃ¶zat
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">ðŸ“Š Ä°statistikler</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Risk Seviyesi DaÄŸÄ±lÄ±mÄ±</span>
                    </div>
                    <div class="progress" style="height: 25px;">
                        <div class="progress-bar bg-success" style="width: 30%">DÃ¼ÅŸÃ¼k</div>
                        <div class="progress-bar bg-warning" style="width: 50%">Orta</div>
                        <div class="progress-bar bg-danger" style="width: 20%">YÃ¼ksek</div>
                    </div>
                </div>
                <hr>
                <div class="row text-center">
                    <div class="col-4">
                        <h4 class="text-success">30%</h4>
                        <small>DÃ¼ÅŸÃ¼k Risk</small>
                    </div>
                    <div class="col-4">
                        <h4 class="text-warning">50%</h4>
                        <small>Orta Risk</small>
                    </div>
                    <div class="col-4">
                        <h4 class="text-danger">20%</h4>
                        <small>YÃ¼ksek Risk</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Dashboard gÃ¼ncelleme (Ã¶rnek)
        console.log('TenderAI Dashboard loaded');
    </script>
}
